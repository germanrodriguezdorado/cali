<div class="animated fadeIn">
  <div class="row">
    <div class="col-lg-12">
      <div class="card">
        <div class="card-header">
          <strong>Agenda</strong>
        </div>
        <div class="card-body">

          <div class="row">
          <div class="form-group col-md-4">
            <input class="form-control" [(ngModel)]="fecha" [owlDateTime]="dt1" [owlDateTimeTrigger]="dt1">
            <owl-date-time [pickerType]="'calendar'" #dt1></owl-date-time>
          </div>

          <div class="form-group col-md-3">
            <button class="btn btn-success btn-block" (click)="buscar()" type="button">Buscar</button>
          </div>
        </div>

          
          
        </div>
      </div>
    </div>
    <!--/.col-->
  </div>
  <div class="row">
    <div class="col-lg-12">
      <div class="card">
        
        <div class="card-body">

          <div role="alert" class="alert alert-warning" *ngIf="agendas.length == 0 && !cargando">
            <strong>Sin resultados!</strong> No se encontraron resultados para la búsqueda ingresada.
          </div>


          <div class="card" *ngFor="let agenda of agendas">
            <div class="card-body">
              <div class="row">
                <div class="col-md-9">
                  <div><h2>{{ agenda["horario"] }}</h2></div>
                  <div>{{ agenda["fecha"] }} </div>
                  <div class="small text-muted mb-3">
                    {{ agenda["cliente_mail"] }}  
                  </div>
                </div>
                <div class="col-md-3">
                  <button class="btn btn-sm btn-success btn-block" type="button" data-toggle="modal" (click)="mostrarModal('atendido', agenda['id'])">Atendido</button>
                  <button class="btn btn-sm btn-primary btn-block" type="button" data-toggle="modal" (click)="mostrarModal('no concurre', agenda['id'])">No concurre</button>
                  <button class="btn btn-sm btn-danger btn-block" type="button" data-toggle="modal" (click)="mostrarModal('cancelar', agenda['id'])">Cancelar</button>

                </div>
              </div>
            </div>
          </div>


          
        </div>
      </div>
    </div>
    <!--/.col-->
  </div>
</div>







<div bsModal #modalAtendido="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Cliente atendido</h4>
        <button type="button" class="close" (click)="modalAtendido.hide()" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p>¿Desea marcar a este cliente como atendido?</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="modalAtendido.hide()">Cancelar</button>
        <button type="button" class="btn btn-primary" (click)="atendido()">Aceptar</button>
      </div>
    </div>
  </div>
</div>




<div bsModal #modalNoConcurre="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Cliente no concurre</h4>
        <button type="button" class="close" (click)="modalNoConcurre.hide()" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p>¿Desea marcar que el cliente no concurrió?</p>

        <div class="form-check">
          <input class="form-check-input" id="checkbox1" type="checkbox" [(ngModel)]="bloquear_email">
          <label class="form-check-label" for="checkbox1"> Bloquear esta casilla de email </label>
        </div>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="modalNoConcurre.hide()">Cancelar</button>
        <button type="button" class="btn btn-primary" (click)="noConcurre()">Aceptar</button>
      </div>
    </div>
  </div>
</div>



<div bsModal #modalCancelar="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Cancelar cita</h4>
        <button type="button" class="close" (click)="modalCancelar.hide()" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        
        <div role="alert" class="alert alert-info">
          <strong>El cliente será avisado por e-mail.</strong><br> Si lo desea, también puede agregar un motivo de cancelación.
        </div>

        <textarea [(ngModel)]="motivo_cancelacion" class="form-control" id="textarea-input" name="textarea-input" placeholder="Escriba el motivo de cancelación.." rows="5"></textarea>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="modalCancelar.hide()">Cerrar</button>
        <button type="button" class="btn btn-primary" (click)="cancelar()">Cancelar cita</button>
      </div>
    </div>
  </div>
</div>
